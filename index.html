<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Comprovante de Inscri√ß√£o</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
body{
  margin:0;
  font-family: "Inter","Segoe UI",Arial,sans-serif;
  background:linear-gradient(135deg,#0f3d1f,#0e7c43);
  min-height:100vh;
  display: flex;
  align-items:flex-start;
  justify-content:flex-start;
  padding-top: 14px;
  padding-left: 90px;
}

.card{
  width:100%;
  max-width:360px;
  background:#ffffff;
  border-radius:18px;
  padding:22px;
  text-align:center;
  box-shadow:0 25px 60px rgba(0,0,0,.35);
}

.top{
  font-weight:800;
   font-size: 36px;   /* aumenta s√≥ esse texto */
  color:#065f46;
  letter-spacing:.10px;
}

h2{
  margin:8px 0 6px;
  color:#0f172a;
}

.info{
  margin-top:10px;
  font-size:14px;
  color:#334155;
}

#qrcode{
  margin:18px 0;
  display:flex;
  justify-content:center;
}

.idbox{
  margin-top:10px;
  font-size:13px;
  color:#475569;
}

.footer{
  margin-top:12px;
  font-size:12px;
  color:#64748b;
}
.idbox{
  border: 2px solid #000;
  padding: 12px 16px;
  margin-top: 12px;
  border-radius: 8px;
  font-size: 20px;   /* tamanho base */
  line-height: 1.5;
}

#dados{
  font-size: 18px;   /* dados maiores */
  font-weight: 500;
  text-align: left;
}

#codigo{
  font-size: 25px;   /* c√≥digo bem grande */
  font-weight: bold;
  color: #000;
  letter-spacing: 2px;
}

#qrcode{
  margin-top: 15px;
}

/* opcional: deixa o QR e os dados com cara de comprovante */
@media print{
  body{
    font-size: 18px;
  }

  #codigo{
    font-size: 40px;
  }

  #dados{
    font-size: 24px;
  }
}
.btn-salvar{
  margin-top:14px;
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  background:#0e7c43;
  color:#fff;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}

.btn-salvar:hover{
  background:#065f46;
  transform:scale(1.02);
}
#comprovante{
  border: 3px solid #0e7c43;
  border-radius: 18px;

  padding: 28px;   /* üëà AUMENTA O RESPIRO */
  box-sizing: border-box;
  background: #fff;
}
</style>
</head>
<body>

<div class="card">
<div id="comprovante">
  <div class="top">UAADEM</div>
  <h2>Comprovante</h2>

  <div class="info">
    Apresente este QR Code na entrada do evento.
  </div>
 <div id="qrcode"></div>
<div id="dados" class="idbox"></div>
<div class="idbox">
  C√≥digo da inscri√ß√£o:<br>
  <strong id="codigo"></strong>
</div>
</div>
<button class="btn-salvar" onclick="salvarComprovanteImagem()">
üíæ Salvar comprovante
</button>

  <div class="footer">
    Valida√ß√£o feita pelo leitor oficial
  </div>

</div>


<script>

const webAppURL = "https://script.google.com/macros/s/AKfycbxM0yPVLY6et5SliwIs91RO081zgR7UM4duCsRdTg3G6FLlIVMDmQ-4ws7vgJpvLWsj/exec";

const params = new URLSearchParams(window.location.search);
let id = params.get("id");

if(!id){
  id = prompt("Digite o c√≥digo da inscri√ß√£o:");
}

if(!id){
  alert("Nenhum ID informado.");
  throw new Error("Sem ID");
}

document.getElementById("codigo").innerText = id;

/* 1Ô∏è‚É£ GERA O QRCODE (continua s√≥ com o ID) */
const urlLeitor = "https://visualtake7-gif.github.io/CONFIRMACAO-INSCRICAO/";
const conteudo = urlLeitor + "?id=" + encodeURIComponent(id);

new QRCode(document.getElementById("qrcode"), {
  text: conteudo,
  width: 200,
  height: 200
});


/* 2Ô∏è‚É£ AGORA busca os dados para montar o comprovante */

fetch(webAppURL + "?id=" + encodeURIComponent(id) + "&modo=dados")
  .then(r => r.json())
  .then(d => {

    if(!d || !d.nome){
      document.getElementById("dados").innerHTML =
        "<b>Inscri√ß√£o n√£o encontrada.</b>";
      return;
    }

    document.getElementById("dados").innerHTML = `
      <b>Nome:</b> ${d.nome}<br>
      <b>Telefone:</b> ${d.telefone}<br>
      <b>E-mail:</b> ${d.email}<br>
      <b>Congrega√ß√£o:</b> ${d.congregacao}<br>
      <b>Grupo:</b> ${d.grupo}<br>
      <b>√Årea:</b> ${d.area}
    `;
  })
  .catch(() => {
    document.getElementById("dados").innerHTML =
      "<b>Erro ao buscar dados da inscri√ß√£o.</b>";
  });
   async function salvarImagem(){

  const comprovante = document.getElementById("comprovante");

  const canvas = await html2canvas(comprovante, {
    scale: 2,
    backgroundColor: "#ffffff"
  });

  const blob = await new Promise(resolve => canvas.toBlob(resolve, "image/png"));

  const file = new File([blob], "comprovante.png", { type: "image/png" });

  // üëâ iPhone / Safari moderno
  if (navigator.canShare && navigator.canShare({ files: [file] })) {

    await navigator.share({
      files: [file],
      title: "Comprovante de inscri√ß√£o"
    });

  } else {

    // fallback (PC / Android / navegadores antigos)
    const link = document.createElement("a");
    link.href = canvas.toDataURL("image/png");
    link.download = "comprovante.png";
    link.click();

  }
}
</script>
</body>
</html>
